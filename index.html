<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Entrenador en Casa</title>
<meta name="theme-color" content="#3b82f6">
<style>
body {font-family: 'Segoe UI', sans-serif; margin:0; background:#0f172a; color:#f8fafc; transition: background 0.5s;}
header {background:linear-gradient(90deg, #06b6d4, #3b82f6); padding:1rem; text-align:center;}
header h1 {margin:0; font-size:1.8rem;}
main {max-width:900px; margin:auto; padding:1rem;}
label {display:block; margin-top:1rem; font-weight:bold;}
select, button, input {width:100%; padding:0.6rem; border-radius:8px; border:none; font-size:1rem; margin-top:0.3rem;}
select, input {background:#1e293b; color:white;}
button {background:#3b82f6; color:white; font-weight:bold; cursor:pointer;}
button:hover {background:#2563eb;}
.ejercicio {background:#1e293b; padding:1rem; border-radius:12px; margin-bottom:1rem;}
.desc {font-size:0.95rem; color:#cbd5e1;}
.timer {display:flex; gap:0.5rem; align-items:center; margin-top:0.5rem;}
.time-display {font-size:1.2rem; font-weight:bold; color:#06b6d4;}
#autoMode {display:none; height:100vh; text-align:center; color:white; padding:2rem;}
#autoMode h2 {font-size:2rem;}
#currentExercise {font-size:2rem; margin-top:1rem;}
#exerciseDesc {font-size:1rem; margin-bottom:1rem; color:#f1f5f9;}
#timerDisplay {font-size:5rem; margin:1rem 0;}
#nextExercise {margin-top:2rem; font-size:1.2rem; color:#cbd5e1;}
</style>
</head>
<body>
<header>
<h1>Entrenador en Casa</h1>
<p>Rutinas de 30 minutos sin equipo</p>
</header>
<main id="setup">
<label for="nivel">Nivel:</label>
<select id="nivel">
<option value="principiante">Principiante</option>
<option value="intermedio">Intermedio</option>
<option value="avanzado">Avanzado</option>
</select>
<label for="objetivo">Objetivo:</label>
<select id="objetivo">
<option value="masa">Ganar masa muscular</option>
<option value="tonificar">Tonificar</option>
<option value="perder">Perder grasa</option>
</select>
<button onclick="mostrarRutina()">Modo Manual</button>
<button onclick="iniciarAutomatico()">Modo Automático</button>
<div id="resultado"></div>
</main>
<div id="autoMode">
<h2 id="estado"></h2>
<div id="currentExercise"></div>
<div id="exerciseDesc"></div>
<div id="timerDisplay"></div>
<div id="nextExercise"></div>
<button id="pauseBtn" onclick="pausarReanudar()">Pausar</button>
</div>
<script>
const manifestData = {
  name: "Entrenador en Casa",
  short_name: "Entrenador",
  start_url: ".",
  display: "standalone",
  background_color: "#0f172a",
  theme_color: "#3b82f6",
  description: "Rutinas de ejercicios en casa sin equipo, con modos manual y automático.",
  icons: []
};
const blob = new Blob([JSON.stringify(manifestData)], {type: 'application/json'});
const manifestURL = URL.createObjectURL(blob);
const manifestLink = document.createElement('link');
manifestLink.rel = 'manifest';
manifestLink.href = manifestURL;
document.head.appendChild(manifestLink);

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register(URL.createObjectURL(new Blob([`
    self.addEventListener("install", e=>{
      e.waitUntil(caches.open("entrenador-cache-v1").then(c=>c.addAll(["./"])));
    });
    self.addEventListener("fetch", e=>{
      e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request)));
    });
  `], {type: 'application/javascript'})));
}

const beepShort = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");
const beepLong = new Audio("https://actions.google.com/sounds/v1/alarms/beep_short.ogg");
let pausado = false, intervalo, indiceActual = 0, tiempoTotal = 0;
let ejerciciosActuales = [];
let descanso = 15;

function crearTemporizador(segundos, display, btn) {
  let tiempo = segundos;
  display.textContent = `${tiempo}s`;
  let intv = setInterval(() => {
    if (!pausado) {
      tiempo--;
      display.textContent = `${tiempo}s`;
      if (tiempo <= 0) {
        clearInterval(intv);
        beepLong.play();
        display.textContent = "¡Completado!";
        btn.disabled = false;
        btn.textContent = "Reiniciar";
        btn.onclick = () => crearTemporizador(segundos, display, btn);
      }
    }
  }, 1000);
}

function mostrarRutina() {
  const nivel = document.getElementById("nivel").value;
  const objetivo = document.getElementById("objetivo").value;
  const lista = rutinas[nivel][objetivo];
  const cont = document.getElementById("resultado");
  cont.innerHTML = `<h2>Rutina ${nivel} - ${objetivo}</h2>` +
    lista.map(ej => {
      let tiempoDefault = (ej.tiempo === "reps") ? 40 : ej.tiempo;
      return `
        <div class="ejercicio">
          <strong>${ej.nombre}</strong>
          <div class="desc">${ej.desc}</div>
          <div class="timer">
            <input type="number" value="${tiempoDefault}" min="5" max="600" style="width:60px;text-align:center;">s
            <button>Iniciar</button>
            <span class="time-display"></span>
          </div>
        </div>
      `;
    }).join("");
  cont.querySelectorAll(".ejercicio").forEach(ejDiv => {
    const btn = ejDiv.querySelector("button");
    const input = ejDiv.querySelector("input");
    const display = ejDiv.querySelector(".time-display");
    btn.onclick = () => {
      btn.disabled = true;
      crearTemporizador(parseInt(input.value), display, btn);
    };
  });
}

function iniciarAutomatico() {
  const nivel = document.getElementById("nivel").value;
  const objetivo = document.getElementById("objetivo").value;
  ejerciciosActuales = rutinas[nivel][objetivo].map(ej => {
    return { ...ej, tiempo: (ej.tiempo === "reps") ? 40 : ej.tiempo };
  });
  document.getElementById("setup").style.display = "none";
  document.getElementById("autoMode").style.display = "block";
  indiceActual = 0;
  tiempoTotal = 0;
  ejecutarEjercicio();
}

function ejecutarEjercicio() {
  if (indiceActual >= ejerciciosActuales.length) {
    document.body.style.background = "#0f172a";
    document.getElementById("autoMode").innerHTML = `<h1>¡Rutina completada!</h1>
      <p>Tiempo total: ${Math.round(tiempoTotal/60)} min</p>
      <button onclick="location.reload()">Reiniciar</button>`;
    return;
  }
  let ej = ejerciciosActuales[indiceActual];
  document.body.style.background = "#2563eb";
  document.getElementById("estado").textContent = "Prepárate";
  document.getElementById("currentExercise").textContent = ej.nombre;
  document.getElementById("exerciseDesc").textContent = ej.desc;
  document.getElementById("nextExercise").textContent = indiceActual+1 < ejerciciosActuales.length 
    ? `Siguiente: ${ejerciciosActuales[indiceActual+1].nombre}` 
    : "Último ejercicio";
  let prep = 3;
  document.getElementById("timerDisplay").textContent = prep;
  intervalo = setInterval(() => {
    if (!pausado) {
      beepShort.play();
      prep--;
      document.getElementById("timerDisplay").textContent = prep;
      if (prep <= 0) {
        clearInterval(intervalo);
        iniciarCuentaAtras(ej.tiempo);
      }
    }
  }, 1000);
}

function iniciarCuentaAtras(tiempo) {
  document.body.style.background = "#16a34a";
  document.getElementById("estado").textContent = "Ejercicio";
  let restante = tiempo;
  document.getElementById("timerDisplay").textContent = restante;
  intervalo = setInterval(() => {
    if (!pausado) {
      restante--;
      tiempoTotal++;
      document.getElementById("timerDisplay").textContent = restante;
      if (restante <= 0) {
        clearInterval(intervalo);
        beepLong.play();
        iniciarDescanso();
      }
    }
  }, 1000);
}

function iniciarDescanso() {
  document.body.style.background = "#dc2626";
  document.getElementById("estado").textContent = "Descanso";
  let restante = descanso;
  document.getElementById("timerDisplay").textContent = restante;
  intervalo = setInterval(() => {
    if (!pausado) {
      restante--;
      tiempoTotal++;
      document.getElementById("timerDisplay").textContent = restante;
      if (restante <= 0) {
        clearInterval(intervalo);
        indiceActual++;
        ejecutarEjercicio();
      }
    }
  }, 1000);
}

function pausarReanudar() {
  pausado = !pausado;
  document.getElementById("pauseBtn").textContent = pausado ? "Reanudar" : "Pausar";
}

const rutinas = {
  principiante: {
    masa: [
      {nombre:"Movilidad articular", desc:"Giros suaves de cuello, hombros, cadera y rodillas", tiempo:180},
      {nombre:"Marcha en el sitio", desc:"Levanta rodillas y mueve brazos", tiempo:120},
      {nombre:"Flexiones inclinadas", desc:"Apoya manos en mesa o pared", tiempo:"reps"},
      {nombre:"Sentadillas", desc:"Pies abiertos al ancho de hombros", tiempo:"reps"},
      {nombre:"Fondos en silla", desc:"Manos en silla, baja y sube", tiempo:"reps"},
      {nombre:"Plancha", desc:"Apoyo de antebrazos, cuerpo recto", tiempo:30},
      {nombre:"Caminar en el sitio", desc:"Movimientos suaves para bajar pulsaciones", tiempo:120},
      {nombre:"Estiramientos", desc:"Estira brazos, piernas y espalda", tiempo:180}
    ],
    tonificar: [
      {nombre:"Jumping jacks", desc:"Saltos abriendo y cerrando piernas y brazos", tiempo:120},
      {nombre:"Trota en el sitio", desc:"Movimientos suaves para activar", tiempo:120},
      {nombre:"Sentadillas", desc:"Baja controlando y sube", tiempo:"reps"},
      {nombre:"Flexiones rodillas apoyadas", desc:"Apoya rodillas y manos, baja y sube", tiempo:"reps"},
      {nombre:"Plancha lateral", desc:"Apoyo lateral, mantener recto", tiempo:20},
      {nombre:"Mountain climbers", desc:"Rodillas al pecho rápido", tiempo:30},
      {nombre:"Caminar suave", desc:"Recuperar respiración", tiempo:120},
      {nombre:"Estiramientos", desc:"Brazos, piernas, cuello", tiempo:180}
    ],
    perder: [
      {nombre:"Jumping jacks", desc:"Saltos con brazos y piernas", tiempo:120},
      {nombre:"Trota en el sitio", desc:"Movimientos rápidos", tiempo:120},
      {nombre:"Burpees", desc:"Salto + flexión", tiempo:"reps"},
      {nombre:"Sentadillas con salto", desc:"Baja y salta explosivo", tiempo:"reps"},
      {nombre:"Mountain climbers", desc:"Rodillas al pecho rápido", tiempo:30},
      {nombre:"Plancha", desc:"Mantén firme el core", tiempo:20},
      {nombre:"Caminar suave", desc:"Baja pulsaciones", tiempo:120},
      {nombre:"Estiramientos", desc:"Estira todo el cuerpo", tiempo:180}
    ]
  },
  intermedio: {
    masa: [
      {nombre:"Calentamiento dinámico", desc:"Rotaciones articulares y movilidad general", tiempo:180},
      {nombre:"Zancadas", desc:"Alterna piernas bajando rodillas al suelo", tiempo:"reps"},
      {nombre:"Flexiones normales", desc:"Manos al ancho de hombros", tiempo:"reps"},
      {nombre:"Fondos en silla", desc:"Baja y sube controlando", tiempo:"reps"},
      {nombre:"Plancha", desc:"Core firme", tiempo:40},
      {nombre:"Burpees", desc:"Flexión + salto", tiempo:"reps"},
      {nombre:"Caminar suave", desc:"Recupera pulsaciones", tiempo:120},
      {nombre:"Estiramientos", desc:"Brazos, piernas y espalda", tiempo:180}
    ],
    tonificar: [
      {nombre:"Skipping alto", desc:"Rodillas al pecho", tiempo:60},
      {nombre:"Sentadillas", desc:"Baja y sube controlado", tiempo:"reps"},
      {nombre:"Flexiones tríceps", desc:"Codos pegados al cuerpo", tiempo:"reps"},
      {nombre:"Plancha lateral", desc:"Mantén alineado", tiempo:30},
      {nombre:"Mountain climbers", desc:"Rápidos", tiempo:40},
      {nombre:"Saltos laterales", desc:"Agilidad", tiempo:30},
      {nombre:"Caminar suave", desc:"Recupera", tiempo:120},
      {nombre:"Estiramientos", desc:"Finaliza relajado", tiempo:180}
    ],
    perder: [
      {nombre:"Jumping jacks", desc:"Saltos", tiempo:60},
      {nombre:"Sprints en el sitio", desc:"Alta intensidad", tiempo:30},
      {nombre:"Burpees", desc:"Potentes", tiempo:"reps"},
      {nombre:"Sentadillas con salto", desc:"Explosivas", tiempo:"reps"},
      {nombre:"Mountain climbers", desc:"Explosivos", tiempo:40},
      {nombre:"Saltos laterales", desc:"Agilidad", tiempo:30},
      {nombre:"Caminar suave", desc:"Recupera", tiempo:60},
      {nombre:"Estiramientos", desc:"Finaliza relajado", tiempo:180}
    ]
  },
  avanzado: {
    masa: [
      {nombre:"Calentamiento intenso", desc:"Movilidad y activación muscular", tiempo:180},
      {nombre:"Zancadas con salto", desc:"Explosivas alternando", tiempo:"reps"},
      {nombre:"Flexiones diamante", desc:"Manos juntas formando triángulo", tiempo:"reps"},
      {nombre:"Burpees con flexión", desc:"Completo", tiempo:"reps"},
      {nombre:"Plancha con toques de hombro", desc:"Core firme", tiempo:40},
      {nombre:"Sentadillas pistol asistidas", desc:"Una pierna", tiempo:"reps"},
      {nombre:"Caminar suave", desc:"Recupera", tiempo:60},
      {nombre:"Estiramientos", desc:"Relaja todo", tiempo:180}
    ],
    tonificar: [
      {nombre:"Skipping alto", desc:"Rodillas al pecho", tiempo:60},
      {nombre:"Sentadillas", desc:"Control y fuerza", tiempo:"reps"},
      {nombre:"Flexiones con palmada", desc:"Explosivas", tiempo:"reps"},
      {nombre:"Plancha lateral con elevación", desc:"Dificultad extra", tiempo:30},
      {nombre:"Mountain climbers", desc:"Rápidos", tiempo:40},
      {nombre:"Saltos laterales", desc:"Agilidad", tiempo:30},
      {nombre:"Caminar suave", desc:"Recupera", tiempo:60},
      {nombre:"Estiramientos", desc:"Finaliza relajado", tiempo:180}
    ],
    perder: [
      {nombre:"Jump squats", desc:"Saltos verticales", tiempo:"reps"},
      {nombre:"Mountain climbers", desc:"Explosivos", tiempo:40},
      {nombre:"Saltos laterales", desc:"Agilidad", tiempo:30},
      {nombre:"Plancha", desc:"Mantén firme", tiempo:40},
      {nombre:"Caminar suave", desc:"Recupera", tiempo:60},
      {nombre:"Estiramientos", desc:"Finaliza relajado", tiempo:180}
    ]
  }
};
</script>
</body>
</html>
